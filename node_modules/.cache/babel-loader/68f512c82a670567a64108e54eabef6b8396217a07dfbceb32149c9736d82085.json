{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nexport default function useBookSearch(query, pageNumber) {\n  _s();\n  const [books, setBooks] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(false);\n  const [hasMore, setHasMore] = useState(false);\n  useEffect(() => {\n    setLoading(true);\n    setError(false);\n    let cancel = null;\n    axios({\n      method: \"GET\",\n      url: \"http://openlibrary.org/search.json\",\n      params: {\n        q: query,\n        page: pageNumber\n      },\n      cancelToken: new axios.CancelToken(c => cancel = c)\n    }).then(res => {\n      console.log(\"data: \", res.data.docs.map(book => {\n        return book.title;\n      }));\n      setBooks(prev => {\n        return [...new Set([...prev, res.data.docs.map(book => {\n          return book.title;\n        })])];\n      });\n      setHasMore(res.data.docs.length > 0);\n      setLoading(false);\n    }).catch(e => {\n      // console.log(\"error: \", e);\n      if (axios.isCancel(e)) return;\n    });\n    return () => {\n      cancel();\n    };\n  }, [query, pageNumber]);\n  return null;\n}\n_s(useBookSearch, \"qxgYOQ3MjdJj0eDD9uMvT2zDwTc=\");","map":{"version":3,"names":["React","useEffect","useState","axios","useBookSearch","query","pageNumber","books","setBooks","loading","setLoading","error","setError","hasMore","setHasMore","cancel","method","url","params","q","page","cancelToken","CancelToken","c","then","res","console","log","data","docs","map","book","title","prev","Set","length","catch","e","isCancel"],"sources":["/Users/akashgupta/Documents/github/my-code/coding-play/react/infinite-loading/src/useBookSearch.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\n\nexport default function useBookSearch(query, pageNumber) {\n\n    const [books, setBooks] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(false);\n    const [hasMore, setHasMore] = useState(false);\n\n    useEffect(() => {\n        setLoading(true);\n        setError(false);\n        let cancel = null;\n        axios({\n            method: \"GET\",\n            url: \"http://openlibrary.org/search.json\",\n            params: { q: query, page: pageNumber },\n            cancelToken: new axios.CancelToken(c => cancel = c)\n        }).then(res => {\n            console.log(\"data: \", res.data.docs.map(book => { return book.title }));\n            setBooks(prev => {\n                return [...new Set([...prev, res.data.docs.map(book => { return book.title })])];\n            });\n            setHasMore(res.data.docs.length > 0);\n            setLoading(false);\n        }).catch(e => {\n            // console.log(\"error: \", e);\n            if (axios.isCancel(e)) return\n        });\n\n        return () => {\n            cancel();\n        }\n    }, [query, pageNumber]);\n    return null;\n}\n"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,OAAOC,KAAK,MAAM,OAAO;AAEzB,eAAe,SAASC,aAAa,CAACC,KAAK,EAAEC,UAAU,EAAE;EAAA;EAErD,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGN,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACO,OAAO,EAAEC,UAAU,CAAC,GAAGR,QAAQ,CAAC,IAAI,CAAC;EAC5C,MAAM,CAACS,KAAK,EAAEC,QAAQ,CAAC,GAAGV,QAAQ,CAAC,KAAK,CAAC;EACzC,MAAM,CAACW,OAAO,EAAEC,UAAU,CAAC,GAAGZ,QAAQ,CAAC,KAAK,CAAC;EAE7CD,SAAS,CAAC,MAAM;IACZS,UAAU,CAAC,IAAI,CAAC;IAChBE,QAAQ,CAAC,KAAK,CAAC;IACf,IAAIG,MAAM,GAAG,IAAI;IACjBZ,KAAK,CAAC;MACFa,MAAM,EAAE,KAAK;MACbC,GAAG,EAAE,oCAAoC;MACzCC,MAAM,EAAE;QAAEC,CAAC,EAAEd,KAAK;QAAEe,IAAI,EAAEd;MAAW,CAAC;MACtCe,WAAW,EAAE,IAAIlB,KAAK,CAACmB,WAAW,CAACC,CAAC,IAAIR,MAAM,GAAGQ,CAAC;IACtD,CAAC,CAAC,CAACC,IAAI,CAACC,GAAG,IAAI;MACXC,OAAO,CAACC,GAAG,CAAC,QAAQ,EAAEF,GAAG,CAACG,IAAI,CAACC,IAAI,CAACC,GAAG,CAACC,IAAI,IAAI;QAAE,OAAOA,IAAI,CAACC,KAAK;MAAC,CAAC,CAAC,CAAC;MACvExB,QAAQ,CAACyB,IAAI,IAAI;QACb,OAAO,CAAC,GAAG,IAAIC,GAAG,CAAC,CAAC,GAAGD,IAAI,EAAER,GAAG,CAACG,IAAI,CAACC,IAAI,CAACC,GAAG,CAACC,IAAI,IAAI;UAAE,OAAOA,IAAI,CAACC,KAAK;QAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACpF,CAAC,CAAC;MACFlB,UAAU,CAACW,GAAG,CAACG,IAAI,CAACC,IAAI,CAACM,MAAM,GAAG,CAAC,CAAC;MACpCzB,UAAU,CAAC,KAAK,CAAC;IACrB,CAAC,CAAC,CAAC0B,KAAK,CAACC,CAAC,IAAI;MACV;MACA,IAAIlC,KAAK,CAACmC,QAAQ,CAACD,CAAC,CAAC,EAAE;IAC3B,CAAC,CAAC;IAEF,OAAO,MAAM;MACTtB,MAAM,EAAE;IACZ,CAAC;EACL,CAAC,EAAE,CAACV,KAAK,EAAEC,UAAU,CAAC,CAAC;EACvB,OAAO,IAAI;AACf;AAAC,GAjCuBF,aAAa"},"metadata":{},"sourceType":"module","externalDependencies":[]}